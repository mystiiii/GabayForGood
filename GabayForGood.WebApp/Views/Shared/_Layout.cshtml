<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
        @if (ViewData["Title"]?.ToString() == "Admin Dashboard")
        {
            @ViewData["Title"]
        }
        else
        {
            @($"{ViewData["Title"]} Gabay For Good")
        }
    </title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/GabayForGood.WebApp.styles.css" asp-append-version="true" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

    <style>
        .nav-center-links {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .nav-link-custom {
            position: relative;
            padding: 12px 20px;
            color: #2c3e50;
            text-decoration: none;
            font-weight: 600;
            font-size: 0.95rem;
            border-radius: 25px;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border: 2px solid transparent;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            letter-spacing: 0.5px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }

            .nav-link-custom:hover {
                color: #007bff;
                background: linear-gradient(135deg, #ffffff, #f8f9fa);
                border-color: #007bff;
                transform: translateY(-2px);
                box-shadow: 0 4px 15px rgba(0, 123, 255, 0.2);
                text-decoration: none;
            }

            .nav-link-custom.active {
                color: white;
                background: linear-gradient(135deg, #007bff, #0056b3);
                border-color: #0056b3;
                box-shadow: 0 3px 12px rgba(0, 123, 255, 0.3);
            }

            .nav-link-custom i {
                font-size: 0.9rem;
                margin-right: 6px;
                transition: transform 0.3s ease;
            }

            .nav-link-custom:hover i {
                transform: scale(1.1);
            }

        .nav-links {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        /* Responsive adjustments */
        @@media (max-width: 768px) {
            .nav-center-links

        {
            gap: 10px;
        }

        .nav-links {
            gap: 10px;
        }

        .nav-link-custom {
            padding: 10px 16px;
            font-size: 0.9rem;
        }

            .nav-link-custom span.nav-text {
                display: none;
            }

            .nav-link-custom i {
                margin-right: 0;
                font-size: 1rem;
            }

        }

        /* Active state detection */
        .nav-link-custom[href*="Home/Index"]:target,
        .nav-link-custom[href*="User/Browse"]:target,
        .nav-link-custom[href*="Organization/Projects"]:target {
            color: white;
            background: linear-gradient(135deg, #007bff, #0056b3);
        }
    </style>
</head>
<body>
    <header class="main-header px-3">
        <div class="container-fluid">
            <div class="row align-items-center">
                <div class="col-md-4 d-flex align-items-center">
                    <a asp-controller="Home" asp-action="Index" class="navbar-brand-custom">Gabay For Good</a>
                </div>
                <div class="col-md-4 d-flex justify-content-center">
                    <div class="nav-center-links">
                        <!-- Center section now empty, keeping for layout -->
                    </div>
                </div>
                <div class="col-md-4 d-flex justify-content-end">
                    <div class="nav-links">
                        @{
                            string displayName = "";

                            if (User.Identity != null && User.Identity.IsAuthenticated)
                            {
                                if (User.IsInRole("User"))
                                {
                                    var firstName = User.FindFirst("FirstName")?.Value ?? "";
                                    var lastName = User.FindFirst("LastName")?.Value ?? "";
                                    displayName = $"{firstName} {lastName}".Trim();
                                }
                                else if (User.IsInRole("Organization"))
                                {
                                    displayName = User.FindFirst("Name")?.Value ?? User.Identity.Name ?? "Organization";
                                }
                                else
                                {
                                    displayName = User.Identity.Name ?? "User";
                                }
                            }
                        }

                        @if (User.Identity != null && User.Identity.IsAuthenticated)
                        {
                            <a asp-controller="Home" asp-action="Index" asp-route-home="true" class="nav-link-custom">
                                <i class="fas fa-home me-1"></i>Home
                            </a>

                            @if (User.IsInRole("User"))
                            {
                                <a asp-controller="User" asp-action="Browse" class="nav-link-custom">
                                    <i class="fas fa-search me-1"></i>Browse
                                </a>
                            }
                            else if (User.IsInRole("Organization"))
                            {
                                <a asp-controller="Organization" asp-action="Index" class="nav-link-custom">
                                    <i class="fas fa-project-diagram me-1"></i>Projects
                                </a>
                            }

                            <div class="dropdown">
                                <button class="btn dropdown-toggle nav-link-custom" type="button" id="userDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                    @displayName
                                </button>
                                <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
                                    @if (User.IsInRole("Organization"))
                                    {
                                        <li>
                                            <a class="dropdown-item" asp-controller="Organization" asp-action="EditProfileOrg">
                                                <i class="fas fa-user-edit me-2"></i>Edit Profile
                                            </a>
                                        </li>
                                        <li>
                                            <a class="dropdown-item" asp-controller="Organization" asp-action="Index">
                                                <i class="fas fa-tachometer-alt me-2"></i>Dashboard
                                            </a>
                                        </li>
                                    }
                                    else if (User.IsInRole("User"))
                                    {
                                        <li>
                                            <a class="dropdown-item" asp-controller="User" asp-action="ViewAccount">
                                                <i class="fas fa-user me-2"></i>Account
                                            </a>
                                        </li>
                                        <li>
                                            <a class="dropdown-item" asp-controller="User" asp-action="History">
                                                <i class="fas fa-history me-2"></i>History
                                            </a>
                                        </li>
                                    }
                                    else
                                    {
                                        <li><a class="dropdown-item" asp-controller="User" asp-action="ViewAccount">Account</a></li>
                                    }
                                    <li><hr class="dropdown-divider"></li>
                                    <li>
                                        <form asp-controller="User" asp-action="SignOut" method="post" class="d-inline w-100">
                                            <button type="submit" class="dropdown-item">
                                                <i class="fas fa-sign-out-alt me-2"></i>Sign Out
                                            </button>
                                        </form>
                                    </li>
                                </ul>
                            </div>
                        }
                        else
                        {
                            <a asp-controller="User" asp-action="SignIn" class="btn-signup">Donate Now!</a>
                        }
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main class="container-main">
        @RenderBody()
    </main>

    <!-- Footer matching the header design -->
    <footer class="main-footer px-3">
        <div class="container-fluid">
            <div class="row align-items-start">
                <div class="col-md-8 mb-4 mb-md-0">
                    <h2 class="footer-brand">Gabay For Good</h2>
                    <p class="footer-description">
                        Empowering Filipino communities through digital giving. We connect compassionate donors with verified NGOs across the Philippines, creating meaningful impact through transparent, secure, and accessible charitable donations that strengthen our nation's spirit of bayanihan.
                    </p>
                </div>
                <div class="col-md-4 footer-contact">
                    <p><strong>+63 (919) 063 2964</strong></p>
                    <p><a href="mailto:info@gabayfor good.ph">info@gabayforgood.ph</a></p>
                    <p style="margin-top: 24px; font-size: 1rem; color: rgba(255,255,255,0.6);">
                        Making every peso count for Filipino communities
                    </p>
                </div>
            </div>

            <hr class="footer-divider">

            <div class="footer-bottom">
                <p style="margin: 0;">&copy; @DateTime.Now.Year Gabay For Good. All rights reserved. | Building bridges between hearts and causes.</p>
            </div>
        </div>
    </footer>

    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>
    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>